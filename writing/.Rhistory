#                           "0.01"=c(4,37,38),
#                           "0.05"=c(12,20,37,44),
#                           "0.2"=c(1,4,22,26)
# )
risk.haplo.f <<- mean(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0) #carrier haplotype frequency
cat("risk.haplo.f = ", risk.haplo.f, "\n")
(n_snp_f <- sum(snp$FREQ1<f))
(n_snp_f_causal <- round(n_snp_f*0.1)) #10 percent of snp with maf < f are causal
risk.variant.id <<- sort(sample(which(0.0001<snp$FREQ1 & snp$FREQ1<f), 7))
risk.haplo.id <- which(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0)
# risk.variant.id <- switch(as.character(f),
#                           "0.005n3"=c(5,32,37),
# 													"0.005n7"=c(5,32,37)
#                           "0.01"=c(4,37,38),
#                           "0.05"=c(12,20,37,44),
#                           "0.2"=c(1,4,22,26)
# )
risk.haplo.f <<- mean(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0) #carrier haplotype frequency
cat("risk.haplo.f = ", risk.haplo.f, "\n")
(n_snp_f <- sum(snp$FREQ1<f))
(n_snp_f_causal <- round(n_snp_f*0.1)) #10 percent of snp with maf < f are causal
risk.variant.id <<- sort(sample(which(0.0001<snp$FREQ1 & snp$FREQ1<f), 7))
risk.haplo.id <- which(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0)
# risk.variant.id <- switch(as.character(f),
#                           "0.005n3"=c(5,32,37),
# 													"0.005n7"=c(5,32,37)
#                           "0.01"=c(4,37,38),
#                           "0.05"=c(12,20,37,44),
#                           "0.2"=c(1,4,22,26)
# )
risk.haplo.f <<- mean(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0) #carrier haplotype frequency
cat("risk.haplo.f = ", risk.haplo.f, "\n")
(n_snp_f <- sum(snp$FREQ1<f))
(n_snp_f_causal <- round(n_snp_f*0.1)) #10 percent of snp with maf < f are causal
risk.variant.id <<- sort(sample(which(0.0001<snp$FREQ1 & snp$FREQ1<f), 7))
risk.haplo.id <- which(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0)
# risk.variant.id <- switch(as.character(f),
#                           "0.005n3"=c(5,32,37),
# 													"0.005n7"=c(5,32,37)
#                           "0.01"=c(4,37,38),
#                           "0.05"=c(12,20,37,44),
#                           "0.2"=c(1,4,22,26)
# )
risk.haplo.f <<- mean(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0) #carrier haplotype frequency
cat("risk.haplo.f = ", risk.haplo.f, "\n")
(n_snp_f <- sum(snp$FREQ1<f))
(n_snp_f_causal <- round(n_snp_f*0.1)) #10 percent of snp with maf < f are causal
risk.variant.id <<- sort(sample(which(0.0001<snp$FREQ1 & snp$FREQ1<f), 7))
risk.haplo.id <- which(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0)
# risk.variant.id <- switch(as.character(f),
#                           "0.005n3"=c(5,32,37),
# 													"0.005n7"=c(5,32,37)
#                           "0.01"=c(4,37,38),
#                           "0.05"=c(12,20,37,44),
#                           "0.2"=c(1,4,22,26)
# )
risk.haplo.f <<- mean(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0) #carrier haplotype frequency
cat("risk.haplo.f = ", risk.haplo.f, "\n")
(n_snp_f <- sum(snp$FREQ1<f))
(n_snp_f_causal <- round(n_snp_f*0.1)) #10 percent of snp with maf < f are causal
risk.variant.id <<- sort(sample(which(0.0001<snp$FREQ1 & snp$FREQ1<f), 7))
risk.haplo.id <- which(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0)
# risk.variant.id <- switch(as.character(f),
#                           "0.005n3"=c(5,32,37),
# 													"0.005n7"=c(5,32,37)
#                           "0.01"=c(4,37,38),
#                           "0.05"=c(12,20,37,44),
#                           "0.2"=c(1,4,22,26)
# )
risk.haplo.f <<- mean(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0) #carrier haplotype frequency
cat("risk.haplo.f = ", risk.haplo.f, "\n")
(n_snp_f <- sum(snp$FREQ1<f))
(n_snp_f_causal <- round(n_snp_f*0.1)) #10 percent of snp with maf < f are causal
risk.variant.id <<- sort(sample(which(0.0001<snp$FREQ1 & snp$FREQ1<f), 7))
risk.haplo.id <- which(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0)
# risk.variant.id <- switch(as.character(f),
#                           "0.005n3"=c(5,32,37),
# 													"0.005n7"=c(5,32,37)
#                           "0.01"=c(4,37,38),
#                           "0.05"=c(12,20,37,44),
#                           "0.2"=c(1,4,22,26)
# )
risk.haplo.f <<- mean(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0) #carrier haplotype frequency
cat("risk.haplo.f = ", risk.haplo.f, "\n")
(n_snp_f <- sum(snp$FREQ1<f))
(n_snp_f_causal <- round(n_snp_f*0.1)) #10 percent of snp with maf < f are causal
risk.variant.id <<- sort(sample(which(0.0001<snp$FREQ1 & snp$FREQ1<f), 7))
risk.haplo.id <- which(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0)
# risk.variant.id <- switch(as.character(f),
#                           "0.005n3"=c(5,32,37),
# 													"0.005n7"=c(5,32,37)
#                           "0.01"=c(4,37,38),
#                           "0.05"=c(12,20,37,44),
#                           "0.2"=c(1,4,22,26)
# )
risk.haplo.f <<- mean(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0) #carrier haplotype frequency
cat("risk.haplo.f = ", risk.haplo.f, "\n")
(n_snp_f <- sum(snp$FREQ1<f))
(n_snp_f_causal <- round(n_snp_f*0.1)) #10 percent of snp with maf < f are causal
risk.variant.id <<- sort(sample(which(0.0001<snp$FREQ1 & snp$FREQ1<f), 7))
risk.haplo.id <- which(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0)
# risk.variant.id <- switch(as.character(f),
#                           "0.005n3"=c(5,32,37),
# 													"0.005n7"=c(5,32,37)
#                           "0.01"=c(4,37,38),
#                           "0.05"=c(12,20,37,44),
#                           "0.2"=c(1,4,22,26)
# )
risk.haplo.f <<- mean(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0) #carrier haplotype frequency
cat("risk.haplo.f = ", risk.haplo.f, "\n")
(n_snp_f <- sum(snp$FREQ1<f))
(n_snp_f_causal <- round(n_snp_f*0.1)) #10 percent of snp with maf < f are causal
risk.variant.id <<- sort(sample(which(0.0001<snp$FREQ1 & snp$FREQ1<f), 7))
risk.haplo.id <- which(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0)
# risk.variant.id <- switch(as.character(f),
#                           "0.005n3"=c(5,32,37),
# 													"0.005n7"=c(5,32,37)
#                           "0.01"=c(4,37,38),
#                           "0.05"=c(12,20,37,44),
#                           "0.2"=c(1,4,22,26)
# )
risk.haplo.f <<- mean(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0) #carrier haplotype frequency
cat("risk.haplo.f = ", risk.haplo.f, "\n")
(n_snp_f <- sum(snp$FREQ1<f))
(n_snp_f_causal <- round(n_snp_f*0.1)) #10 percent of snp with maf < f are causal
risk.variant.id <<- sort(sample(which(0.0001<snp$FREQ1 & snp$FREQ1<f), 7))
risk.haplo.id <- which(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0)
# risk.variant.id <- switch(as.character(f),
#                           "0.005n3"=c(5,32,37),
# 													"0.005n7"=c(5,32,37)
#                           "0.01"=c(4,37,38),
#                           "0.05"=c(12,20,37,44),
#                           "0.2"=c(1,4,22,26)
# )
risk.haplo.f <<- mean(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0) #carrier haplotype frequency
cat("risk.haplo.f = ", risk.haplo.f, "\n")
(n_snp_f <- sum(snp$FREQ1<f))
(n_snp_f_causal <- round(n_snp_f*0.1)) #10 percent of snp with maf < f are causal
risk.variant.id <<- sort(sample(which(0.0001<snp$FREQ1 & snp$FREQ1<f), 7))
risk.haplo.id <- which(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0)
# risk.variant.id <- switch(as.character(f),
#                           "0.005n3"=c(5,32,37),
# 													"0.005n7"=c(5,32,37)
#                           "0.01"=c(4,37,38),
#                           "0.05"=c(12,20,37,44),
#                           "0.2"=c(1,4,22,26)
# )
risk.haplo.f <<- mean(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0) #carrier haplotype frequency
cat("risk.haplo.f = ", risk.haplo.f, "\n")
(n_snp_f <- sum(snp$FREQ1<f))
(n_snp_f_causal <- round(n_snp_f*0.1)) #10 percent of snp with maf < f are causal
risk.variant.id <<- sort(sample(which(0.0001<snp$FREQ1 & snp$FREQ1<f), 7))
risk.haplo.id <- which(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0)
# risk.variant.id <- switch(as.character(f),
#                           "0.005n3"=c(5,32,37),
# 													"0.005n7"=c(5,32,37)
#                           "0.01"=c(4,37,38),
#                           "0.05"=c(12,20,37,44),
#                           "0.2"=c(1,4,22,26)
# )
risk.haplo.f <<- mean(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0) #carrier haplotype frequency
cat("risk.haplo.f = ", risk.haplo.f, "\n")
(n_snp_f <- sum(snp$FREQ1<f))
(n_snp_f_causal <- round(n_snp_f*0.1)) #10 percent of snp with maf < f are causal
risk.variant.id <<- sort(sample(which(0.0001<snp$FREQ1 & snp$FREQ1<f), 7))
risk.haplo.id <- which(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0)
# risk.variant.id <- switch(as.character(f),
#                           "0.005n3"=c(5,32,37),
# 													"0.005n7"=c(5,32,37)
#                           "0.01"=c(4,37,38),
#                           "0.05"=c(12,20,37,44),
#                           "0.2"=c(1,4,22,26)
# )
risk.haplo.f <<- mean(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0) #carrier haplotype frequency
cat("risk.haplo.f = ", risk.haplo.f, "\n")
(n_snp_f <- sum(snp$FREQ1<f))
(n_snp_f_causal <- round(n_snp_f*0.1)) #10 percent of snp with maf < f are causal
risk.variant.id <<- sort(sample(which(0.0001<snp$FREQ1 & snp$FREQ1<f), 7))
risk.haplo.id <- which(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0)
# risk.variant.id <- switch(as.character(f),
#                           "0.005n3"=c(5,32,37),
# 													"0.005n7"=c(5,32,37)
#                           "0.01"=c(4,37,38),
#                           "0.05"=c(12,20,37,44),
#                           "0.2"=c(1,4,22,26)
# )
risk.haplo.f <<- mean(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0) #carrier haplotype frequency
cat("risk.haplo.f = ", risk.haplo.f, "\n")
(n_snp_f <- sum(snp$FREQ1<f))
(n_snp_f_causal <- round(n_snp_f*0.1)) #10 percent of snp with maf < f are causal
risk.variant.id <<- sort(sample(which(0.0001<snp$FREQ1 & snp$FREQ1<f), 7))
risk.haplo.id <- which(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0)
# risk.variant.id <- switch(as.character(f),
#                           "0.005n3"=c(5,32,37),
# 													"0.005n7"=c(5,32,37)
#                           "0.01"=c(4,37,38),
#                           "0.05"=c(12,20,37,44),
#                           "0.2"=c(1,4,22,26)
# )
risk.haplo.f <<- mean(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0) #carrier haplotype frequency
cat("risk.haplo.f = ", risk.haplo.f, "\n")
(n_snp_f <- sum(snp$FREQ1<f))
(n_snp_f_causal <- round(n_snp_f*0.1)) #10 percent of snp with maf < f are causal
risk.variant.id <<- sort(sample(which(0.0001<snp$FREQ1 & snp$FREQ1<f), 7))
risk.haplo.id <- which(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0)
# risk.variant.id <- switch(as.character(f),
#                           "0.005n3"=c(5,32,37),
# 													"0.005n7"=c(5,32,37)
#                           "0.01"=c(4,37,38),
#                           "0.05"=c(12,20,37,44),
#                           "0.2"=c(1,4,22,26)
# )
risk.haplo.f <<- mean(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0) #carrier haplotype frequency
cat("risk.haplo.f = ", risk.haplo.f, "\n")
(n_snp_f <- sum(snp$FREQ1<f))
(n_snp_f_causal <- round(n_snp_f*0.1)) #10 percent of snp with maf < f are causal
risk.variant.id <<- sort(sample(which(0.0001<snp$FREQ1 & snp$FREQ1<f), 7))
risk.haplo.id <- which(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0)
# risk.variant.id <- switch(as.character(f),
#                           "0.005n3"=c(5,32,37),
# 													"0.005n7"=c(5,32,37)
#                           "0.01"=c(4,37,38),
#                           "0.05"=c(12,20,37,44),
#                           "0.2"=c(1,4,22,26)
# )
risk.haplo.f <<- mean(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0) #carrier haplotype frequency
cat("risk.haplo.f = ", risk.haplo.f, "\n")
(n_snp_f <- sum(snp$FREQ1<f))
(n_snp_f_causal <- round(n_snp_f*0.1)) #10 percent of snp with maf < f are causal
risk.variant.id <<- sort(sample(which(0.0001<snp$FREQ1 & snp$FREQ1<f), 7))
risk.haplo.id <- which(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0)
# risk.variant.id <- switch(as.character(f),
#                           "0.005n3"=c(5,32,37),
# 													"0.005n7"=c(5,32,37)
#                           "0.01"=c(4,37,38),
#                           "0.05"=c(12,20,37,44),
#                           "0.2"=c(1,4,22,26)
# )
risk.haplo.f <<- mean(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0) #carrier haplotype frequency
cat("risk.haplo.f = ", risk.haplo.f, "\n")
(n_snp_f <- sum(snp$FREQ1<f))
(n_snp_f_causal <- round(n_snp_f*0.1)) #10 percent of snp with maf < f are causal
risk.variant.id <<- sort(sample(which(0.0001<snp$FREQ1 & snp$FREQ1<f), 7))
risk.haplo.id <- which(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0)
# risk.variant.id <- switch(as.character(f),
#                           "0.005n3"=c(5,32,37),
# 													"0.005n7"=c(5,32,37)
#                           "0.01"=c(4,37,38),
#                           "0.05"=c(12,20,37,44),
#                           "0.2"=c(1,4,22,26)
# )
risk.haplo.f <<- mean(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0) #carrier haplotype frequency
cat("risk.haplo.f = ", risk.haplo.f, "\n")
(n_snp_f <- sum(snp$FREQ1<f))
(n_snp_f_causal <- round(n_snp_f*0.1)) #10 percent of snp with maf < f are causal
risk.variant.id <<- sort(sample(which(0.0001<snp$FREQ1 & snp$FREQ1<f), 7))
risk.haplo.id <- which(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0)
# risk.variant.id <- switch(as.character(f),
#                           "0.005n3"=c(5,32,37),
# 													"0.005n7"=c(5,32,37)
#                           "0.01"=c(4,37,38),
#                           "0.05"=c(12,20,37,44),
#                           "0.2"=c(1,4,22,26)
# )
risk.haplo.f <<- mean(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0) #carrier haplotype frequency
cat("risk.haplo.f = ", risk.haplo.f, "\n")
(n_snp_f <- sum(snp$FREQ1<f))
(n_snp_f_causal <- round(n_snp_f*0.1)) #10 percent of snp with maf < f are causal
risk.variant.id <<- sort(sample(which(0.0001<snp$FREQ1 & snp$FREQ1<f), 7))
risk.haplo.id <- which(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0)
# risk.variant.id <- switch(as.character(f),
#                           "0.005n3"=c(5,32,37),
# 													"0.005n7"=c(5,32,37)
#                           "0.01"=c(4,37,38),
#                           "0.05"=c(12,20,37,44),
#                           "0.2"=c(1,4,22,26)
# )
risk.haplo.f <<- mean(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0) #carrier haplotype frequency
cat("risk.haplo.f = ", risk.haplo.f, "\n")
risk.variant.id
(n_snp_f <- sum(snp$FREQ1<f))
(n_snp_f_causal <- round(n_snp_f*0.1)) #10 percent of snp with maf < f are causal
risk.variant.id <<- sort(sample(which(0.0001<snp$FREQ1 & snp$FREQ1<f), 7))
risk.haplo.id <- which(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0)
# risk.variant.id <- switch(as.character(f),
#                           "0.005n3"=c(5,32,37),
# 													"0.005n7"=c(5,32,37)
#                           "0.01"=c(4,37,38),
#                           "0.05"=c(12,20,37,44),
#                           "0.2"=c(1,4,22,26)
# )
risk.haplo.f <<- mean(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0) #carrier haplotype frequency
cat("risk.haplo.f = ", risk.haplo.f, "\n")
(n_snp_f <- sum(snp$FREQ1<f))
(n_snp_f_causal <- round(n_snp_f*0.1)) #10 percent of snp with maf < f are causal
risk.variant.id <<- sort(sample(which(0.0001<snp$FREQ1 & snp$FREQ1<f), 7))
risk.haplo.id <- which(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0)
# risk.variant.id <- switch(as.character(f),
#                           "0.005n3"=c(5,32,37),
# 													"0.005n7"=c(5,32,37)
#                           "0.01"=c(4,37,38),
#                           "0.05"=c(12,20,37,44),
#                           "0.2"=c(1,4,22,26)
# )
risk.haplo.f <<- mean(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0) #carrier haplotype frequency
cat("risk.haplo.f = ", risk.haplo.f, "\n")
(n_snp_f <- sum(snp$FREQ1<f))
(n_snp_f_causal <- round(n_snp_f*0.1)) #10 percent of snp with maf < f are causal
risk.variant.id <<- sort(sample(which(0.0001<snp$FREQ1 & snp$FREQ1<f), 7))
risk.haplo.id <- which(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0)
# risk.variant.id <- switch(as.character(f),
#                           "0.005n3"=c(5,32,37),
# 													"0.005n7"=c(5,32,37)
#                           "0.01"=c(4,37,38),
#                           "0.05"=c(12,20,37,44),
#                           "0.2"=c(1,4,22,26)
# )
risk.haplo.f <<- mean(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0) #carrier haplotype frequency
cat("risk.haplo.f = ", risk.haplo.f, "\n")
(n_snp_f <- sum(snp$FREQ1<f))
(n_snp_f_causal <- round(n_snp_f*0.1)) #10 percent of snp with maf < f are causal
risk.variant.id <<- sort(sample(which(0.0001<snp$FREQ1 & snp$FREQ1<0.003), 7))
risk.haplo.id <- which(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0)
# risk.variant.id <- switch(as.character(f),
#                           "0.005n3"=c(5,32,37),
# 													"0.005n7"=c(5,32,37)
#                           "0.01"=c(4,37,38),
#                           "0.05"=c(12,20,37,44),
#                           "0.2"=c(1,4,22,26)
# )
risk.haplo.f <<- mean(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0) #carrier haplotype frequency
cat("risk.haplo.f = ", risk.haplo.f, "\n")
(n_snp_f <- sum(snp$FREQ1<f))
(n_snp_f_causal <- round(n_snp_f*0.1)) #10 percent of snp with maf < f are causal
risk.variant.id <<- sort(sample(which(0.0001<snp$FREQ1 & snp$FREQ1<0.003), 7))
risk.haplo.id <- which(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0)
# risk.variant.id <- switch(as.character(f),
#                           "0.005n3"=c(5,32,37),
# 													"0.005n7"=c(5,32,37)
#                           "0.01"=c(4,37,38),
#                           "0.05"=c(12,20,37,44),
#                           "0.2"=c(1,4,22,26)
# )
risk.haplo.f <<- mean(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0) #carrier haplotype frequency
cat("risk.haplo.f = ", risk.haplo.f, "\n")
(n_snp_f <- sum(snp$FREQ1<f))
(n_snp_f_causal <- round(n_snp_f*0.1)) #10 percent of snp with maf < f are causal
risk.variant.id <<- sort(sample(which(0.0001<snp$FREQ1 & snp$FREQ1<0.003), 7))
risk.haplo.id <- which(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0)
# risk.variant.id <- switch(as.character(f),
#                           "0.005n3"=c(5,32,37),
# 													"0.005n7"=c(5,32,37)
#                           "0.01"=c(4,37,38),
#                           "0.05"=c(12,20,37,44),
#                           "0.2"=c(1,4,22,26)
# )
risk.haplo.f <<- mean(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0) #carrier haplotype frequency
cat("risk.haplo.f = ", risk.haplo.f, "\n")
(n_snp_f <- sum(snp$FREQ1<f))
(n_snp_f_causal <- round(n_snp_f*0.1)) #10 percent of snp with maf < f are causal
risk.variant.id <<- sort(sample(which(0.0001<snp$FREQ1 & snp$FREQ1<0.003), 7))
risk.haplo.id <- which(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0)
# risk.variant.id <- switch(as.character(f),
#                           "0.005n3"=c(5,32,37),
# 													"0.005n7"=c(5,32,37)
#                           "0.01"=c(4,37,38),
#                           "0.05"=c(12,20,37,44),
#                           "0.2"=c(1,4,22,26)
# )
risk.haplo.f <<- mean(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0) #carrier haplotype frequency
cat("risk.haplo.f = ", risk.haplo.f, "\n")
(n_snp_f <- sum(snp$FREQ1<f))
(n_snp_f_causal <- round(n_snp_f*0.1)) #10 percent of snp with maf < f are causal
risk.variant.id <<- sort(sample(which(0.0001<snp$FREQ1 & snp$FREQ1<0.003), 7))
risk.haplo.id <- which(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0)
# risk.variant.id <- switch(as.character(f),
#                           "0.005n3"=c(5,32,37),
# 													"0.005n7"=c(5,32,37)
#                           "0.01"=c(4,37,38),
#                           "0.05"=c(12,20,37,44),
#                           "0.2"=c(1,4,22,26)
# )
risk.haplo.f <<- mean(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0) #carrier haplotype frequency
cat("risk.haplo.f = ", risk.haplo.f, "\n")
(n_snp_f <- sum(snp$FREQ1<f))
(n_snp_f_causal <- round(n_snp_f*0.1)) #10 percent of snp with maf < f are causal
risk.variant.id <<- sort(sample(which(0.0001<snp$FREQ1 & snp$FREQ1<0.003), 7))
risk.haplo.id <- which(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0)
# risk.variant.id <- switch(as.character(f),
#                           "0.005n3"=c(5,32,37),
# 													"0.005n7"=c(5,32,37)
#                           "0.01"=c(4,37,38),
#                           "0.05"=c(12,20,37,44),
#                           "0.2"=c(1,4,22,26)
# )
risk.haplo.f <<- mean(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0) #carrier haplotype frequency
cat("risk.haplo.f = ", risk.haplo.f, "\n")
(n_snp_f <- sum(snp$FREQ1<f))
(n_snp_f_causal <- round(n_snp_f*0.1)) #10 percent of snp with maf < f are causal
risk.variant.id <<- sort(sample(which(0.0001<snp$FREQ1 & snp$FREQ1<0.003), 7))
risk.haplo.id <- which(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0)
# risk.variant.id <- switch(as.character(f),
#                           "0.005n3"=c(5,32,37),
# 													"0.005n7"=c(5,32,37)
#                           "0.01"=c(4,37,38),
#                           "0.05"=c(12,20,37,44),
#                           "0.2"=c(1,4,22,26)
# )
risk.haplo.f <<- mean(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0) #carrier haplotype frequency
cat("risk.haplo.f = ", risk.haplo.f, "\n")
(n_snp_f <- sum(snp$FREQ1<f))
(n_snp_f_causal <- round(n_snp_f*0.1)) #10 percent of snp with maf < f are causal
risk.variant.id <<- sort(sample(which(0.0001<snp$FREQ1 & snp$FREQ1<0.003), 7))
risk.haplo.id <- which(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0)
# risk.variant.id <- switch(as.character(f),
#                           "0.005n3"=c(5,32,37),
# 													"0.005n7"=c(5,32,37)
#                           "0.01"=c(4,37,38),
#                           "0.05"=c(12,20,37,44),
#                           "0.2"=c(1,4,22,26)
# )
risk.haplo.f <<- mean(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0) #carrier haplotype frequency
cat("risk.haplo.f = ", risk.haplo.f, "\n")
risk.variant.id
snp$FREQ1[c(6, 18, 23, 34, 38, 43, 44)]
sum(snp$FREQ1[c(6, 18, 23, 34, 38, 43, 44)])
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
# The palette with black:
cbbPalette <- c("#000000", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
#check power using true, imputed founder carrier, minimum offspring carrier
#three versions -- command and rare and super rare #2 for common, 7 for rare, 39 for super rare
result <- read.csv("figure 4b. fouder imputatuion estimate nontransmitted by population f see power.csv", header=T)
result <- result %>% gather(key="method", value="p.value", -c(1:8))
result.plot <- result %>% group_by(f, risk.haplo.f, r, method) %>%
summarise(n=n(), power=mean(p.value<0.05, na.rm=T))
# result.plot$method <- factor(result.plot$method, labels=c("w.o. imputation", "pop.f", "pop.f off 5%", "pop.f off 10%",
#                                                 "pop.f off 20%", "pop.f off 50%", "pop.f off -5%", "pop.f off -10%"
#                                                 , "pop.f off -20%", "pop.f off -50%"))
#only include 20%off
pd <- position_dodge(0.0)
filter(result.plot, !grepl("conditional|10%|5%|50%", method)) %>% ggplot(aes(x=r, y=power, ymax=max(power), group=method, col=method)) +
#   geom_point(size=3, alpha=1) +
facet_wrap(~f, ncol=3, scale="free_x") +
geom_line(size=1.2, alpha=0.7, position=pd) +
geom_point(size=1.2, position=pd) +
#   ggtitle("f=0.202, consider effect size of risk haplotypes, TRAP") +
#   ggtitle("f=0.0178, consider effect size of risk haplotypes, TRAP") +
#   ggtitle("f=0.0039, consider effect size of risk haplotypes, TRAP") +
labs(x="odds ratio r") +
scale_y_continuous(limits=c(0,1)) +
theme_gray(base_size = 20) +
theme(legend.position="right", panel.background = element_rect(fill = 'grey85')) +
scale_color_manual(values=cbbPalette)
#everything
pd <- position_dodge(0.0)
filter(result.plot, !grepl("conditional", method)) %>% ggplot(aes(x=r, y=power, ymax=max(power), group=method, col=method)) +
#   geom_point(size=3, alpha=1) +
facet_wrap(~f, ncol=3, scale="free_x") +
geom_line(size=1.2, alpha=0.7, position=pd) +
geom_point(size=1.2, position=pd) +
#   ggtitle("f=0.202, consider effect size of risk haplotypes, TRAP") +
#   ggtitle("f=0.0178, consider effect size of risk haplotypes, TRAP") +
#   ggtitle("f=0.0039, consider effect size of risk haplotypes, TRAP") +
labs(x="odds ratio r") +
scale_y_continuous(limits=c(0,1)) +
theme_gray(base_size = 20) +
theme(legend.position="right", panel.background = element_rect(fill = 'grey85'))
snp$FREQ1[c(5,32,37)]
sum(snp$FREQ1[c(5,32,37)])
f=0.005
f="0.005n3"
(n_snp_f <- sum(snp$FREQ1<f))
(n_snp_f_causal <- round(n_snp_f*0.1)) #10 percent of snp with maf < f are causal
# risk.variant.id <<- sort(sample(which(0.0001<snp$FREQ1 & snp$FREQ1<f), n_snp_f_causal))
# risk.haplo.id <- which(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0)
risk.variant.id <- switch(as.character(f),
"0.005n3"=c(5,32,37),
"0.005n7"=c(6,18,23,34,38,43,44)
"0.01"=c(4,37,38),
"0.05"=c(12,20,37,44),
"0.2"=c(1,4,22,26)
)
risk.haplo.f <<- mean(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0) #carrier haplotype frequency
cat("risk.haplo.f = ", risk.haplo.f, "\n")
(n_snp_f <- sum(snp$FREQ1<f))
(n_snp_f_causal <- round(n_snp_f*0.1)) #10 percent of snp with maf < f are causal
# risk.variant.id <<- sort(sample(which(0.0001<snp$FREQ1 & snp$FREQ1<f), n_snp_f_causal))
# risk.haplo.id <- which(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0)
risk.variant.id <- switch(as.character(f),
"0.005n3"=c(5,32,37),
"0.005n7"=c(6,18,23,34,38,43,44),
"0.01"=c(4,37,38),
"0.05"=c(12,20,37,44),
"0.2"=c(1,4,22,26)
)
risk.haplo.f <<- mean(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0) #carrier haplotype frequency
cat("risk.haplo.f = ", risk.haplo.f, "\n")
f="0.005n7"
(n_snp_f <- sum(snp$FREQ1<f))
(n_snp_f_causal <- round(n_snp_f*0.1)) #10 percent of snp with maf < f are causal
# risk.variant.id <<- sort(sample(which(0.0001<snp$FREQ1 & snp$FREQ1<f), n_snp_f_causal))
# risk.haplo.id <- which(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0)
risk.variant.id <- switch(as.character(f),
"0.005n3"=c(5,32,37),
"0.005n7"=c(6,18,23,34,38,43,44),
"0.01"=c(4,37,38),
"0.05"=c(12,20,37,44),
"0.2"=c(1,4,22,26)
)
risk.haplo.f <<- mean(apply(2-as.matrix(haplotype[, risk.variant.id+2]), 1, sum)>0) #carrier haplotype frequency
cat("risk.haplo.f = ", risk.haplo.f, "\n")
10*100
